# Description

Can you try to get the flag? Beware we have PIE!
Additional details will be available after launching your challenge instance.

# Hints

Can you figure out what changed between the address you found locally and in the server output?

# Solution

The provided source code :

```
#include <stdio.h>
#include <stdlib.h>
#include <signal.h>
#include <unistd.h>

void segfault_handler() {
  printf("Segfault Occurred, incorrect address.\n");
  exit(0);
}

int win() {
  FILE *fptr;
  char c;

  printf("You won!\n");
  // Open file
  fptr = fopen("flag.txt", "r");
  if (fptr == NULL)
  {
      printf("Cannot open file.\n");
      exit(0);
  }

  // Read contents from file
  c = fgetc(fptr);
  while (c != EOF)
  {
      printf ("%c", c);
      c = fgetc(fptr);
  }

  printf("\n");
  fclose(fptr);
}

int main() {
  signal(SIGSEGV, segfault_handler);
  setvbuf(stdout, NULL, _IONBF, 0); // _IONBF = Unbuffered

  printf("Address of main: %p\n", &main);

  unsigned long val;
  printf("Enter the address to jump to, ex => 0x12345: ");
  scanf("%lx", &val);
  printf("Your input: %lx\n", val);

  void (*foo)(void) = (void (*)())val;
  foo();
}
```

The `win()` function seems to contain the flag.  And the netcat connection asks the following :
<br>
![image](https://github.com/user-attachments/assets/4efbf284-fc25-417e-bc80-8c7491ea1f66) 
<br><br>
So, if we can find the position of the `win()` function relative to the `main()` function, we can get the flag. I used GDB to achieve this. <br>
![image](https://github.com/user-attachments/assets/fd15156b-e73c-4102-a0c5-6dc613ce7936)
<br><br>
`main()` is at `0x1345` and `win()` is at `0x12af` . Their difference being, <br>
`0x1345` - `0x12af` = `0x96` <br>

So now, the given adress of main in the nc connection is `0x5829f91a633d` . Which means the `win()` adress should be at,
<br>

`0x5829f91a633d` - `0x96` = `0x5829F91A62A7`

<br>
![flag1](https://github.com/user-attachments/assets/89f132cc-ee81-4c44-adb9-472f48df8ea8)

<br>
And, there's the flag
